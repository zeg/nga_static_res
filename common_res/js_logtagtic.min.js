!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.JSSDK=t()}("undefined"!=typeof window?window:this,function(){var s=null,u=window.app_key||null,t=location.protocol+"//xy-log2.tagtic.cn/mininfo/v1/logs/"+u,d=null,c=0,m=null,o=0,p=0,l="",g="",f="",h={ajax:function(t){t.url=t.url||"",t.method=t.method||"get",t.data=t.data||"",t.callback=t.callback||"",t.async=t.async||!0;var e=null;if("POST"===t.method.toUpperCase()){if("object"==typeof t.data)try{t.data=JSON.stringify(t.data)}catch(e){t.data=""}window.XMLHttpRequest&&"withCredentials"in(e=new window.XMLHttpRequest)&&(e.open("POST",t.url,!0),e.setRequestHeader("Content-Type","text/plain"),e.onreadystatechange=function(){e.readyState},e.send(t.data))}},md5:function(e){return hex_md5(e+"")},setCookie:function(e,t,o){var n=this.GetFirstLevelDomain();o=o||24;var i=new Date;i.setTime(i.getTime()+36e5*o),document.cookie=e+"="+escape(t)+";expires="+i.toGMTString()+";domain="+n+";path=/"},getCookie:function(e){return null!==(e=window.document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)")))?unescape(e[2]):null},GetFirstLevelDomain:function(e){if(e){if(!(e=e.match(/^(?:[a-z0-9]+:\/\/)?([^\/]+)/)))return"unknow";e=e[1]}else e=document.location.hostname;return(e=e.match(/[^\.]+\.(?:(?:com|co|net|org|gov|edu|mil|biz|name|info|mobi|pro|travel|museum|int|areo|post|rec)\.)?[^\.]+$/))?e[0]:"unknow"},addEvent:function(e,t,o,n){commonui.aE(e,t,o)}};function w(e){e.appkey&&"app_key"!==u&&h.ajax({method:"post",url:t,data:e})}function _(e){if(e.cookie=h.getCookie("taihe"),e.page_id=m,e.short_cookie=h.getCookie("taihe_session"),e.appkey=u,e.http_url.match(/^https?:\/\//)&&e.cookie){if("jump"===e.event){if(e=function(e){if(!e.to_target.match(/^https?:\/\//))return e.to_target=null,e;var t=h.GetFirstLevelDomain(e.to_target);return g===t&&(e.to_target=null),e}(e),!o)w({cookie:h.getCookie("taihe"),page_id:m,short_cookie:h.getCookie("taihe_session"),appkey:u,http_url:l,timestamp:(new Date).toISOString(),event:"duration",duration:parseInt(((new Date).getTime()-s)/1e3)}),o=1;if(e.to_target)return void w(e)}if("load"!==e.event){if("close"===e.event)w({cookie:h.getCookie("taihe"),page_id:m,short_cookie:h.getCookie("taihe_session"),appkey:u,http_url:l,timestamp:(new Date).toISOString(),event:"duration",duration:parseInt(((new Date).getTime()-s)/1e3)})}else w(e)}}function n(e,t,o){e&&w({cookie:h.getCookie("taihe"),page_id:m,short_cookie:h.getCookie("taihe_session"),appkey:u,http_url:f,timestamp:(new Date).toISOString(),event:"duration",duration:parseInt(((new Date).getTime()-s)/1e3)});if(l=t||window.location.href,g=h.GetFirstLevelDomain(),s=(new Date).getTime(),m=h.md5(l+s),!h.getCookie("taihe")){c=1;var n=navigator.userAgent+(new Date).getTime(),i=h.md5(n);h.setCookie("taihe",i,43800)}h.getCookie("taihe_session")?h.setCookie("taihe_session",h.getCookie("taihe_session"),1/6):h.setCookie("taihe_session",h.md5((new Date).getTime()),1/6),p||(p=1,h.addEvent(window,"beforeunload",function(e){if(e.target && e.target.activeElement){"a"!=e.target.activeElement.nodeName.toLowerCase()&&_({to_target:e.target.links[0].href,http_url:l,timestamp:(new Date).toISOString(),event:"close"})}}),h.addEvent(document.body,"click",function(e){for(var t=e.target||e.srcElement,o=0;o<3;o++){if(!t)return;if("A"==t.nodeName)return void _({to_target:t.getAttribute("href"),http_url:l,timestamp:(new Date).toISOString(),event:"jump"});t=t.parentNode}}));var a,r;a=o,r=e?f:a||(document.referrer?document.referrer:null),_({status:200,http_user_agent:navigator.userAgent,request_method:"get",timestamp:(new Date).toISOString(),http_url:l,http_x_forwarded_for:d,event:"load",is_new:c,http_referer:r}),f=l}function e(){}return window.__LOATAGTIC={init:function(e,t,o){n(e,t,o)}},n(),null==window.JSSDK&&(window.JSSDK=e),e});